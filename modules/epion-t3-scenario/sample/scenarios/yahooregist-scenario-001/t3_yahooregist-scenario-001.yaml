t3: "1.0"
type: "scenario"
info:
    id: "yahooregist-scenario-001"
    version: "1.0.0"
    summary: "Yahooアカウント新規作成"
    description: "Yahooの新規アカウント取得用シナリオ"
flows:
  - id: "flow-0001"
    type: "ReadFileIterate"
    target: "${scenario.scenarioDir}/test.csv"
    fileType: "csv"
    encoding: "UTF-8"
    lineSeparator: "LF"
    wrapstring: "DC"
    children:
      - type: CommandExecute
        ref: command-0001
      - type: CommandExecute
        ref: command-0002
      - type: CommandExecute
        ref: command-0003
      - type: CommandExecute
        ref: command-0004
      - type: CommandExecute
        ref: command-0005
      - type: CommandExecute
        ref: command-0006
      - type: CommandExecute
        ref: command-0007
      - type: CommandExecute
        ref: command-0008
      - type: CommandExecute
        ref: command-0010
      - type: CommandExecute
        ref: command-0020
      - type: CommandExecute
        ref: command-0021
      - type: CommandExecute
        ref: command-0022
      - type: CommandExecute
        ref: command-0030
      - type: CommandExecute
        ref: command-0031
      - type: CommandExecute
        ref: command-0040
      - type: CommandExecute
        ref: command-0050
      - type: CommandExecute
        ref: command-0060
      - type: CommandExecute
        ref: command-0061
      - type: CommandExecute
        ref: command-0070
      - type: CommandExecute
        ref: command-0080
      - type: CommandExecute
        ref: command-0090
      - type: CommandExecute
        ref: command-0091
      - type: CommandExecute
        ref: command-0110
      - type: CommandExecute
        ref: command-0130
      - type: CommandExecute
        ref: command-0140
      - type: CommandExecute
        ref: command-0170
commands:
  - id: command-0001
    description: "ランダムな文字列を作成."
    summary : "ランダムな文字列を作成."
    command: "GenerateRandomWord"
    target : "mailaddressBefore"
    length: 20
  - id: command-0002
    description: "ランダムな文字列を作成."
    summary : "ランダムな文字列を作成."
    command: "GenerateRandomString"
    target : "mailaddressAfter"
    length: 5
  - id: command-0003
    description: "メアド接頭辞作成."
    summary : "メアドの接頭辞を作成する."
    command: "StringConcat"
    target : "mailaddress"
    referenceVariables : ["scenario.mailaddressBefore", "_", "scenario.mailaddressAfter"]
  - id: command-0004
    description: "姓を作成する."
    summary : "姓を作成する."
    command: "GenerateRandomJapaneseLastName"
    target : "lastName"
  - id: command-0005
    description: "名を作成する."
    summary : "名を作成する."
    command: "GenerateRandomJapaneseFirstName"
    target : "firstName"
  - id: command-0006
    description: "姓名を作成する."
    summary : "姓名を作成する."
    command: "StringConcat"
    target : "name"
    referenceVariables : ["scenario.lastName", "　", "scenario.firstName"]
  - id: command-0007
    description: "ランダムな文字列を作成."
    summary : "ランダムな文字列を作成."
    command: "GenerateRandomString"
    target : "password"
    length: 10
  - id: command-0008
    description: "郵便番号を作成."
    summary : "ランダムな文字列を作成."
    command: "GenerateRandomJapaneseZipCode"
    target : "zipcode"
  - id: command-0010
    description: "SeleniumのWebDriverを開始します."
    summary : "SeleniumのWebDriverを開始します."
    command: "StartLocalWebDriver"
    browser: chrome
    variableName: WEBDRIVER_1
    driverPath: "/Users/takashimanozomu/work/91_webdrivers/chromedriver"
  - id: command-0020
    summary : Get Url.
    description: Get Url.
    command: "WebDriverGet"
    target : "https://www.yahoo.co.jp/"
    refWebDriver: WEBDRIVER_1
  - id: command-0021
    summary : Get Url.
    description: Get Url.
    command: "WebDriverClick"
    target : "新規取得"
    selector : "linkText"
    refWebDriver: WEBDRIVER_1
  - id: command-0022
    summary : Get Url.
    description: Get Url.
    command: "WebDriverClick"
    target : "メールアドレスなしで登録する"
    selector : "linkText"
    refWebDriver: WEBDRIVER_1
  - id: command-0030
    summary : SendKeys Yahoo ID.
    description: SendKeys Yahoo ID.
    command: "WebDriverClick"
    target : "yid"
    selector : "id"
    refWebDriver: WEBDRIVER_1
  - id: command-0031
    summary : SendKeys Yahoo ID.
    description: SendKeys Yahoo ID.
    command: "WebDriverSendKeys"
    target : "yid"
    value : "${scenario.mailaddress}"
    selector : "id"
    refWebDriver: WEBDRIVER_1
  - id: command-0040
    summary : Sendkeys Password.
    description: Sendkeys Password.
    command: "WebDriverSendKeys"
    target : "passwd"
    value : "${scenario.password}"
    selector : "id"
    refWebDriver: WEBDRIVER_1
  - id: command-0050
    summary : SendKeys Yahoo ID.
    description: SendKeys Yahoo ID.
    command: "WebDriverSendKeys"
    target : "postCode"
    value : "${scenario.zipcode}"
    selector : "id"
    refWebDriver: WEBDRIVER_1
  - id: command-0060
    summary : SendKeys Yahoo ID.
    description: SendKeys Yahoo ID.
    command: "GenerateRandomBirthdayString"
    target : "birthday"
    format : "yyyyMMdd"
  - id: command-0061
    summary : SendKeys Yahoo ID.
    description: SendKeys Yahoo ID.
    command: "WebDriverSendKeys"
    target : "birthday"
    value : "${scenario.birthday}"
    selector : "id"
    refWebDriver: WEBDRIVER_1
  - id: command-0070
    summary : Sendeys Yahoo ID.
    description: SendKeys Yahoo ID.
    command: "WebDriverSendKeys"
    target : "dispname"
    value : "${scenario.name}"
    selector : "id"
    refWebDriver: WEBDRIVER_1
  - id: command-0080
    summary : Sendeys Yahoo ID.
    description: SendKeys Yahoo ID.
    command: "WebDriverSendKeysSpace"
    target : "male"
    value : null
    selector : "id"
    refWebDriver: WEBDRIVER_1
  - id: command-0090
    summary : SendKeys Yahoo ID.
    description: SendKeys Yahoo ID.
    command: "WebDriverSendKeys"
    target : "pw_a"
    value : "東京"
    selector : "id"
    refWebDriver: WEBDRIVER_1
  - id: command-0091
    summary : "Captcha回避まで待機"
    description: "Captcha回避まで待機"
    command: "ConsoleInput"
    target : "Captchaに表示された文字列を入力し終えたら「y」を入力してください"
    value : "captchaInputFlg"
  - id: command-0110
    summary : SendKeys Yahoo ID.
    description: SendKeys Yahoo ID.
    command: "WebDriverClick"
    target : "btnSubmit"
    selector : "id"
    refWebDriver: WEBDRIVER_1
  - id: command-0130
    summary : 登録確認ボタン押下.
    description: 登録確認ボタン押下.
    command: "WebDriverClick"
    target : "commit"
    selector : "id"
    refWebDriver: WEBDRIVER_1
  - id: command-0140
    summary : 同意して登録する確認ボタン押下.
    description: 同意して登録するボタン押下.
    command: "WebDriverClick"
    target : "commit"
    selector : "id"
    refWebDriver: WEBDRIVER_1
  - id: command-0170
    summary : "AccountManagerへ登録."
    description: "AccountManagerへ登録する."
    command: "ExecuteRestApi"
    request:
        method: post
        targetUrl: http://localhost:8080/api/v1/accounts
        headers :
            "Content-Type" : "application/json;charset=UTF-8"
        body: |
            {
                "mailaddress" : "${scenario.mailaddress}@yahoo.co.jp",
                "first_name" : "${scenario.firstName}",
                "last_name" : "${scenario.lastName}",
                "zip_code" : "${scenario.zipcode}",
                "yahoo_id" : "${scenario.mailaddress}",
                "yahoo_password" : "${scenario.password}"
            }
  - id: command-0900
    summary : "WebDriverを閉じる."
    description: "WebDriverを閉じる."
    command: "EndLocalWebDriver"
    refWebDriver: WEBDRIVER_1